<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./css/index.css" />
    <script defer src="../js/hasLiked.js"></script>
    <title>Bài Đăng</title>
  </head>
  <body>
    <div class="post" id="post">
      <div class="post-header">
        <h3>Bài Đăng</h3>
        <div id="likes-count">Likes: <span id="likes-number">0</span></div>
      </div>
      <div class="post-content">Hôm nay code rất vui</div>
      <div>
        <span class="like-btn" id="like-button">Like</span>
        <span class="comment-btn">Bình luận</span>
      </div>
      <div class="comment-section">
        <input type="text" id="comment-input" placeholder="Viết bình luận..." />
        <button id="submit-comment">Gửi</button>
      </div>
    </div>

    <script>
      const postId = 'your-post-id'; // Thay thế bằng ID của bài đăng
      const token = 'your-access-token'; // Thay thế bằng token xác thực của người dùng
      let isLiked = false; // Trạng thái like của người dùng

      // Hàm để xử lý nút like
      const handleLikeToggle = async () => {
        const response = await fetch(`/posts/${postId}/like`, {
          method: 'POST',
          headers: {
            Authorization: `Bearer ${token}`,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ userHasLiked: isLiked }), // Gửi trạng thái like
        });

        if (response.ok) {
          const updatedPost = await response.json();
          document.getElementById('likes-number').textContent =
            updatedPost.likes; // Cập nhật số lượt like
          isLiked = !isLiked; // Chuyển đổi trạng thái like
          document.getElementById('like-button').textContent = isLiked
            ? 'Unlike'
            : 'Like'; // Cập nhật nút like
        } else {
          console.error('Không thể thực hiện thao tác like/unlike');
        }
      };

      document
        .getElementById('like-button')
        .addEventListener('click', handleLikeToggle);

      // Thêm logic cho bình luận nếu cần
      document
        .getElementById('submit-comment')
        .addEventListener('click', () => {
          const commentText = document.getElementById('comment-input').value;
          // Logic gửi bình luận đến backend
          console.log('Bình luận:', commentText);
          document.getElementById('comment-input').value = ''; // Xóa ô nhập bình luận
        });
    </script>
  </body>
</html>
